<!-- 63576c20-aafe-4b82-8336-470215391f65 f38e5246-3d63-4c23-9639-aa027ca1364d -->
# План проверки приложения на соответствие ТЗ

## Проверка модуля 1: Взаимодействие с пользователем

### Требования ТЗ:

- ✅ Регистрация: имя, фамилия, отчество, email, пароль, повтор пароля
- ✅ Обновление информации профиля
- ✅ Мягкое удаление (is_active=False) с logout
- ✅ Login по email и паролю
- ✅ Logout с инвалидацией токена
- ✅ Идентификация пользователя после login (токены)

### Найденные проблемы:

1. **Дублирование проверки прав в mock views** - проверка идет и через permission classes, и через check_resource_permission в методах
2. **Нужно проверить**: После мягкого удаления пользователь не должен иметь возможность залогиниться (проверка есть в login, но нужно убедиться)

## Проверка модуля 2: Система разграничения прав доступа

### Требования ТЗ:

- ✅ Описание схемы в README.md
- ✅ Таблицы в БД реализованы
- ✅ Тестовые данные заполнены
- ⚠️ **Проблема**: 401 ошибка должна возвращаться когда пользователь не аутентифицирован
- ⚠️ **Проблема**: 403 ошибка должна возвращаться когда пользователь аутентифицирован, но не имеет прав
- ✅ Admin API для управления правилами

### Найденные проблемы:

1. **401 ошибка**: DRF по умолчанию возвращает 401 через IsAuthenticated, но нужно убедиться что это работает правильно
2. **403 ошибка**: HasResourcePermission возвращает False, что приводит к 403, но нужно проверить что это работает корректно
3. **Дублирование проверок**: В mock views есть и permission classes, и ручная проверка в методах - это избыточно

## Проверка модуля 3: Mock бизнес-объекты

### Требования ТЗ:

- ✅ Mock views реализованы
- ✅ Проверка прав доступа реализована
- ⚠️ Нужно убрать дублирование проверок

## План исправлений:

1. Убрать дублирование проверок прав в mock views - оставить только permission classes
2. Добавить тесты для проверки 401/403 ошибок
3. Убедиться что после мягкого удаления пользователь не может залогиниться
4. Проверить все endpoints на корректную работу

### To-dos

- [ ] Создать структуру Django проекта с настройками PostgreSQL, DRF и базовой конфигурацией
- [ ] Реализовать модели CustomUser и UserProfile с полями для регистрации (имя, фамилия, отчество, email, пароль)
- [ ] Создать систему токенов (модель Token, генерация, валидация, инвалидация при logout)
- [ ] Реализовать API endpoints для регистрации, login, logout, обновления профиля и мягкого удаления аккаунта
- [ ] Создать модели для RBAC: Role, Resource, Action, Permission, RolePermission, UserRole
- [ ] Реализовать систему проверки прав доступа (permission classes, декораторы для проверки Resource+Action)
- [ ] Создать Admin API для управления ролями, разрешениями, ресурсами и назначениями прав
- [ ] Реализовать mock views для бизнес-объектов (products, orders) с проверкой прав доступа
- [ ] Создать fixtures с тестовыми данными (роли, разрешения, пользователи)
- [ ] Написать README.md с описанием схемы доступа, API endpoints и инструкциями по запуску
- [ ] Проверить модуль аутентификации: регистрация, login, logout, обновление профиля, мягкое удаление
- [ ] Проверить систему прав доступа: 401 для неаутентифицированных, 403 для без прав
- [ ] Убрать дублирование проверок прав в mock views - оставить только permission classes
- [ ] Проверить что после мягкого удаления пользователь не может залогиниться
- [ ] Проверить Admin API для управления правами доступа
- [ ] Проверить все API endpoints на корректную работу